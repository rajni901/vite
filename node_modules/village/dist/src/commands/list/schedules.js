"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.schedules = void 0;
const tslib_1 = require("tslib");
const auth_1 = require("@common/auth");
const dates_1 = require("@common/dates");
const villageClient_1 = require("@common/villageClient");
const cli_table3_1 = tslib_1.__importDefault(require("cli-table3"));
const schedules = (program) => {
    program
        .command('schedules')
        .description('List script schedules')
        .argument('id', 'The id of the script to list schedules for.')
        .action(function () {
        const id = program.args[1];
        const debug = this.opts().debug;
        villageClient_1.villageClient.scripts
            .getScriptSchedules(id)
            .then((schedules) => {
            const table = new cli_table3_1.default({
                head: ['ID', 'Schedule', 'Created at'],
            });
            for (const schedule of schedules) {
                table.push([
                    schedule.id,
                    `${schedule.minute} ${schedule.hour} ${schedule.day_of_month} ${schedule.month_of_year} ${schedule.day_of_week}`,
                    (0, dates_1.getTimeSince)(schedule.created_at),
                ]);
            }
            console.log(table.toString());
        })
            .catch(auth_1.warnUnauthenticated)
            .catch((err) => {
            if (err.status === 404) {
                console.log(`Script ${id} not found.`);
            }
            debug && console.error(err);
        });
    });
};
exports.schedules = schedules;
//# sourceMappingURL=schedules.js.map