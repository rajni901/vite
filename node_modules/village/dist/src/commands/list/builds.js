"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.builds = void 0;
const tslib_1 = require("tslib");
const auth_1 = require("@common/auth");
const dates_1 = require("@common/dates");
const villageClient_1 = require("@common/villageClient");
const cli_table3_1 = tslib_1.__importDefault(require("cli-table3"));
const builds = (program) => {
    program
        .command('builds')
        .description('List script builds')
        .argument('id', 'The id of the script to list builds for.')
        .action(function () {
        const id = program.args[1];
        const debug = this.opts().debug;
        villageClient_1.villageClient.scripts
            .getScriptBuilds(id)
            .then((builds) => {
            const table = new cli_table3_1.default({
                head: ['ID', 'Status', 'Created at'],
            });
            for (const build of builds) {
                table.push([
                    build.id,
                    build.status,
                    (0, dates_1.getTimeSince)(build.created_at),
                ]);
            }
            console.log(table.toString());
        })
            .catch(auth_1.warnUnauthenticated)
            .catch((err) => {
            if (err.status === 404) {
                console.log(`Script ${id} not found.`);
            }
            debug && console.error(err);
        });
    });
};
exports.builds = builds;
//# sourceMappingURL=builds.js.map