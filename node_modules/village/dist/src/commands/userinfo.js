"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.userinfo = exports.getAuth0UserInfo = void 0;
const tslib_1 = require("tslib");
const axios_1 = tslib_1.__importDefault(require("axios"));
const auth_1 = require("@common/auth");
const _config_1 = require("@config");
const getAuth0UserInfo = async (providedTokens) => {
    const tokens = providedTokens ? providedTokens : await (0, auth_1.getTokens)();
    if (!tokens) {
        return {
            errors: "You're not authenticated",
        };
    }
    const { access_token } = tokens;
    try {
        const { data } = await axios_1.default.get(`${_config_1.AUTH0_DOMAIN}/userinfo`, {
            headers: {
                Authorization: `Bearer ${access_token}`,
            },
        });
        return {
            data,
        };
    }
    catch (err) {
        return {
            errors: 'User not found',
        };
    }
};
exports.getAuth0UserInfo = getAuth0UserInfo;
const userinfo = (program) => {
    program
        .command('userinfo')
        .description('Get user info')
        .action(async function () {
        const debug = this.opts().debug;
        const { data, errors } = await (0, exports.getAuth0UserInfo)();
        debug && console.log(errors);
        console.log(data);
    });
};
exports.userinfo = userinfo;
//# sourceMappingURL=userinfo.js.map